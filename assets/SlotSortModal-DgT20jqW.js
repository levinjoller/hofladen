const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SelectWithSearch-D6un5e8Q.js","assets/vendor-ionic-DL3WDV-g.js","assets/vendor-grid-Bad8I008.js","assets/index-YNPHqK-K.js","assets/index-CfmnWJvu.css","assets/search-type-BiWLnLKr.js","assets/LoadingSpinner-DgHZcYJm.js","assets/LoadingSpinner-BxrlA5ZL.css","assets/StockColumnSlotSelectPage-DSZ2Xjb1.js","assets/PaloxListPage-BxSjq6nu.js","assets/product-types-CV3CSiow.js","assets/customer-list-schema-BqaoqCG1.js","assets/persons-CQb0edLH.js","assets/supplier-list-schema-DiLhSYiL.js","assets/PaloxListPage-CL6JbNxr.css","assets/StockColumnSlotSelectPage-pgblD3gl.css","assets/DroppableSlotContentPage-BzZlKBHH.js","assets/DroppableSlotContentPage-BVCAwG7J.css"])))=>i.map(i=>d[i]);
import{a as $,b as E,w as m,t as h,h as L,c as z,d as H,e as W,A as j,k as K,v as Q,_,C as Y}from"./vendor-ionic-DL3WDV-g.js";import{d as G,f as J,b as X,c as Z,p as x}from"./index-YNPHqK-K.js";import{F as P,u as ee,g as te,h as oe,d as se}from"./PaloxListPage-BxSjq6nu.js";import{L as y}from"./LoadingSpinner-DgHZcYJm.js";import{k as ne,b as re,q as f,m as d,x as s,Q as o,u as e,R as ae,U as k,l as g,v as I,Y as C,e as M}from"./vendor-grid-Bad8I008.js";import"./product-types-CV3CSiow.js";import"./customer-list-schema-BqaoqCG1.js";import"./persons-CQb0edLH.js";import"./supplier-list-schema-DiLhSYiL.js";const le=()=>({currentStep:1,selectedStrategy:null,selectedStock:null,selectedStockColumnSlot:[],originalOrder:[],newOrder:[],_isActionLoading:!1,actionErrorMessage:null}),ie=G("slotReorderStore",{state:()=>le(),getters:{isActionLoading(){return this._isActionLoading},getActionErrorMessage(){return this.actionErrorMessage},isFinalStep(){return this.selectedStrategy?this.selectedStrategy.isFinalStep(this.currentStep):!1},canProceed(t){return!t.selectedStrategy||t.currentStep===1?!!t.selectedStock:t.currentStep===2?t.selectedStrategy.canProceed(t.selectedStockColumnSlot):!0},hasChanges(t){return t.newOrder.some(n=>{const p=te(t.originalOrder,n.slotId);return p?!oe(p.paloxIds,n.paloxIds):!0})}},actions:{initializeState(t,n){this.$reset(),this.selectedStrategy=n,t&&(this.selectedStock=t,this.currentStep=2)},setReorderedPaloxes(t,n){this.newOrder=ee(this.newOrder,t,n)},setOriginalOrder(t){this.originalOrder=t.map(n=>({slotId:n.slotId,paloxIds:[...n.paloxIds]}))},setStrategyActionStatus(t,n){this._isActionLoading=t,this.actionErrorMessage=n},async nextStep(){if(!this.selectedStrategy||!this.canProceed)return P;if(this.selectedStrategy.isFinalStep(this.currentStep)){const{executeFinalAction:t}=this.selectedStrategy;return t?await t(this):P}return this.currentStep++,{success:!0,parentReloadRequired:!1,closeModal:!1,isCompleted:!1}},prevStep(){this.currentStep>1&&this.currentStep--}}}),de={key:0},ce={key:1},ue={key:2},Se={key:1},Ce=ne({__name:"SlotSortModal",props:{title:{},currentStock:{},activeStrategy:{}},setup(t){const n=C({loader:()=>_(()=>import("./SelectWithSearch-D6un5e8Q.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),loadingComponent:y,delay:200}),p=C({loader:()=>_(()=>import("./StockColumnSlotSelectPage-DSZ2Xjb1.js"),__vite__mapDeps([8,1,2,9,3,4,6,7,10,11,12,13,14,15])),loadingComponent:y,delay:200}),V=C({loader:()=>_(()=>import("./DroppableSlotContentPage-BzZlKBHH.js"),__vite__mapDeps([16,1,2,6,3,4,7,9,10,11,12,13,14,17])),loadingComponent:y,delay:200}),v=t,u=ie(),{prevStep:b,nextStep:T}=u,{currentStep:S,canProceed:w,isActionLoading:O,isFinalStep:F,selectedStock:l,selectedStockColumnSlot:c,actionErrorMessage:R}=J(u);re(()=>{u.initializeState(v.currentStock,v.activeStrategy)});async function B(){const{success:a,parentReloadRequired:r,closeModal:i}=await T();if(a){if(i){const q=D();x(q,"success",6e3),A(r)}}else R.value&&x(R.value,"danger",1e4)}function D(){const a=l.value?.display_name??"im ausgewählten Lager",r=c.value.map(i=>i.display_name).join(", ");return`Umsortierung erfolgreich gespeichert! (Lager: ${a}; Plätze: ${r})`}function N(a){u.setOriginalOrder([a])}function U({slotId:a,paloxIds:r}){u.setReorderedPaloxes(a,r)}function A(a){Y.dismiss(a)}return(a,r)=>(d(),f(e(Q),null,{default:s(()=>[o(e($),null,{default:s(()=>[o(e(E),null,{default:s(()=>[o(e(m),{slot:"start"},{default:s(()=>[o(e(h),{onClick:e(b),disabled:e(S)===1},{default:s(()=>[o(e(L),{icon:e(X)},null,8,["icon"])]),_:1},8,["onClick","disabled"])]),_:1}),o(e(z),null,{default:s(()=>[ae(k(t.title)+" - "+k(e(S))+" / 3",1)]),_:1}),o(e(m),{slot:"end"},{default:s(()=>[o(e(h),{onClick:r[0]||(r[0]=i=>A(!1))},{default:s(()=>[o(e(L),{icon:e(Z)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),o(e(H),{class:"ion-padding"},{default:s(()=>[e(S)===1?(d(),g("div",de,[o(e(W),null,{default:s(()=>[o(e(n),{title:"Lager",modelValue:e(l),"onUpdate:modelValue":r[1]||(r[1]=i=>M(l)?l.value=i:null),fetchMethod:e(se),isSearchable:!1},null,8,["modelValue","fetchMethod"])]),_:1})])):e(S)===2?(d(),g("div",ce,[e(l)?(d(),f(e(p),{key:0,modelValue:e(c),"onUpdate:modelValue":r[2]||(r[2]=i=>M(c)?c.value=i:null),selectedStock:e(l),activeStrategy:t.activeStrategy},null,8,["modelValue","selectedStock","activeStrategy"])):I("",!0)])):e(S)===3?(d(),g("div",ue,[e(c)&&e(l)?(d(),f(e(V),{key:0,slot:e(c),selectedStock:e(l),onInitialOrder:N,onChangedOrder:U},null,8,["slot","selectedStock"])):I("",!0)])):I("",!0)]),_:1}),o(e(j),null,{default:s(()=>[o(e(E),null,{default:s(()=>[o(e(m),{slot:"end"},{default:s(()=>[o(e(h),{onClick:B,disabled:!e(w)||e(O)},{default:s(()=>[e(O)?(d(),f(e(K),{key:0,name:"crescent"})):(d(),g("span",Se,k(e(F)?"Speichern":"Weiter"),1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{Ce as default};
