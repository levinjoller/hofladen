import{X as q,g as D,i as R,e as $}from"./vendor-ionic-DL3WDV-g.js";import{u as K,L as A}from"./LoadingSpinner-DgHZcYJm.js";import{i as G}from"./is-numeric-key-DsADXjeW.js";import{S as l}from"./search-type-BiWLnLKr.js";import{p as O,_ as Q}from"./index-YNPHqK-K.js";import{k as U,w as W,b as X,n as x,r as y,c as _,l as g,m as c,q as d,v as L,u as n,W as j,U as N,x as S,G as z,S as H,Q as J,R as P}from"./vendor-grid-Bad8I008.js";function Y(a,f,i){const u=f??l.Text;if(u===l.Numeric){const t=a.replace(/\D/g,"");return t.length===0?null:parseInt(t,10)}if(u===l.Text){const t=a.trim();if(t.length>=i)return t}return null}const Z={key:2},ee={class:"ion-text-center"},te=U({__name:"InlineSearch",props:{title:{},fetchMethod:{type:Function},isSearchable:{type:Boolean},searchType:{},placeholder:{},minLength:{}},emits:["select"],setup(a,{emit:f}){const i=a,u=f,t=y(""),h=y(!1),m=y(null),{data:r,isLoading:E,errorMessage:B,execute:p}=K(i.fetchMethod);W(B,e=>{e&&O(e,"danger",1e4)});let b=0;const o=_(()=>i.searchType??l.Text),k=_(()=>i.minLength??(o.value===l.Text?3:1));X(async()=>{i.isSearchable?await C():await p()});async function C(){await x(),setTimeout(()=>{F();const e=m.value?.$el?.querySelector("input");e&&(e.removeEventListener("keydown",T),e.addEventListener("keydown",T))},100)}function F(){m.value?.$el?.setFocus?.()}function T(e){e.key==="Enter"?M():o.value===l.Numeric&&!G(e)&&e.preventDefault()}const M=()=>{r.value.length>0&&I(r.value[0])},V=async e=>{const v=e.target.value;t.value=v;const s=Y(v,o.value,k.value),w=++b;if(s===null){r.value=[];return}o.value===l.Numeric?await p(s):await p(s)},I=async e=>{h.value||(h.value=!0,u("select",e),t.value="",r.value=[],await x(),h.value=!1)};return(e,v)=>(c(),g("div",null,[a.isSearchable?(c(),d(n(q),{key:0,ref_key:"searchbarRef",ref:m,placeholder:`Suche ${a.title}...`,inputmode:o.value,debounce:300,onIonInput:V,"show-clear-button":"always",animated:""},null,8,["placeholder","inputmode"])):L("",!0),n(E)?(c(),d(A,{key:1})):n(r).length===0&&(!a.isSearchable||t.value.length>=k.value)?(c(),g("div",Z,[j("p",ee,"Kein/e "+N(a.title)+" gefunden.",1)])):n(r).length>0?(c(),d(n($),{key:3},{default:S(()=>[(c(!0),g(z,null,H(n(r),s=>(c(),d(n(D),{key:s.id,button:"",onClick:w=>I(s)},{default:S(()=>[J(n(R),null,{default:S(()=>[P(N(s.display_name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):L("",!0)]))}}),ie=Q(te,[["__scopeId","data-v-6d8abd8d"]]);export{ie as default};
