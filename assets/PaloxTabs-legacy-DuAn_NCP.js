System.register(["./index-legacy-CXiE44-D.js","./use-db-action-legacy-C83uysaO.js","./product-types-legacy-BV8aepTp.js","./customer-list-schema-legacy-DHITW-W7.js","./supplier-list-schema-legacy-Be-rA8nd.js","./PaloxListPage-legacy-CY-5kvXM.js","./_plugin-vue_export-helper-legacy-BVIICed7.js"],function(e,t){"use strict";var a,o,n,s,l,r,i,c,d,p,u,m,_,h,f,g,v,y,k,w,b,x,S,M,C,P,j,I,z,T,D,$,B,H,N,A,L,E,q,O,F,G,J,V,K;return{setters:[e=>{a=e.t,o=e.ar,n=e.d,s=e.r,l=e.c,r=e.A,i=e.o,c=e.b,d=e.w,p=e.e,u=e.f,m=e.s,_=e.as,h=e.at,f=e.F,g=e.au,v=e.av,y=e.h,k=e.aw,w=e.ax,b=e.ay,x=e.az,S=e.aA,M=e.i,C=e.l,P=e.H,j=e.y,I=e.aB,z=e.G,T=e._},e=>{D=e.o,$=e.i,B=e.a,H=e.p,N=e.d,A=e.b,L=e.s,E=e.c,q=e.g},e=>{O=e.P,F=e.a},e=>{G=e.a},e=>{J=e.a},e=>{V=e.L},e=>{K=e._}],execute:function(){var Q=document.createElement("style");Q.textContent=".toolbar-content[data-v-972fe490]{display:flex;justify-content:space-around;align-items:center}.ripple-parent[data-v-972fe490]{position:relative;overflow:hidden;flex-grow:1;display:flex;align-items:center;justify-content:center;height:56px;cursor:pointer}.popover-buttons[data-v-972fe490]{display:flex;justify-content:space-between;gap:8px;margin-top:10px}\n/*$vite$:1*/",document.head.appendChild(Q),e({a:async function(e=""){let t=a.from("suppliers").select("\n      id,\n      person:fk_person!inner (\n        display_name\n      )\n    "),o=e.trim();o&&(t=t.ilike("person.display_name",`%${o}%`).limit(5));const{data:n,error:s}=await t;if(s)throw s;if(!n)return[];const l=oe.safeParse(n);if(!l.success)throw l.error;return l.data.map(e=>({id:e.id,display_name:e.person.display_name})).sort((e,t)=>e.display_name.localeCompare(t.display_name))},b:async function(e=""){let t=a.from("products").select("\n      id, \n      display_name,\n      type:fk_product_type (\n        emoji\n      )\n      ").order("display_name",{ascending:!0}),o=e.trim();o&&(t=t.ilike("display_name",`%${o}%`).limit(15));const{data:n,error:s}=await t;if(s)throw s;if(!n)return[];const l=W.safeParse(n);if(!l.success)throw l.error;return l.data.map(e=>({id:e.id,display_name:`${e.type.emoji} ${e.display_name}`}))},c:fe,d:async function(e=""){let t=a.from("customers").select("\n      id,\n      person:fk_person!inner (\n        display_name\n      )\n    "),o=e.trim();o&&(t=t.ilike("person.display_name",`%${o}%`).limit(5));const{data:n,error:s}=await t;if(s)throw s;if(!n)return[];const l=te.safeParse(n);if(!l.success)throw l.error;return l.data.map(e=>({id:e.id,display_name:e.person.display_name})).sort((e,t)=>e.display_name.localeCompare(t.display_name))},e:async function(e){const{data:t,error:o}=await a.from("stock_column_slots_by_column_view").select().eq("fk_stock",e).order("column_number",{ascending:!0});if(o)throw o;if(!t)return[];const n=re.safeParse(t);if(!n.success)throw n.error;return n.data},f:async function(e){let t=a.from("palox_types").select("id, label_prefix, display_name, is_default").order("is_default",{ascending:!1}).order("label_prefix",{ascending:!0});e&&(t=t.eq("is_default",!0).limit(1));const{data:o,error:n}=await t;if(n)throw n;if(!o)return[];const s=me.safeParse(o);if(!s.success)throw s.error;return s.data.map(e=>({id:e.id,display_name:`${e.label_prefix} (${e.display_name})`}))}});const R=D({p_palox_type_id:$(),p_palox_number:$().min(1).max(9999),p_stock_column_slot_id:$(),p_product_id:$(),p_supplier_id:$(),p_customer_id:$().nullable().optional()}),U=D({...O.omit({created_at:!0,fk_product_type:!0}).shape,type:D({...F.pick({emoji:!0}).shape})}),W=B(U),X=D({id:$(),created_at:H(e=>"string"==typeof e?new Date(e):e,N()),stock:$()});B(X);const Y=D({...X.omit({created_at:!0}).shape}),Z=B(Y),ee=D({...G.omit({created_at:!0}).shape}),te=B(ee),ae=D({...J.omit({created_at:!0}).shape}),oe=B(ae),ne=D({slot_id:$(),display_name:L(),is_full:A(),free_levels:$(),current_taken_levels:$()}),se=B(ne),le=D({stock_column_id:$(),column_number:$(),fk_stock:$(),slots:se}),re=B(le),ie=D({level:$(),palox_id:$(),display_name:L()}),ce=B(ie),de=D({slot_id:$(),slot_display_name:L(),slot:$(),max_level:$(),levels:ce});B(de);const pe=D({id:$(),created_at:H(e=>"string"==typeof e?new Date(e):e,N()),label_prefix:L(),display_name:L(),description:$().nullable(),next_palox_number:$(),is_default:A()});B(pe);const ue=D({...pe.pick({id:!0,label_prefix:!0,display_name:!0,is_default:!0}).shape}),me=B(ue),_e=D({id:$(),created_at:H(e=>"string"==typeof e?new Date(e):e,N()),fk_customer:$().nullable(),fk_product:$(),fk_supplier:$(),fk_stock_column_slot_level:$().nullable(),fk_palox_type:$(),number_per_type:$(),stored_at:H(e=>"string"==typeof e?new Date(e):e,N()).nullable()});B(_e);const he=D({..._e.pick({id:!0,number_per_type:!0}).shape});async function fe(){const{data:e,error:t}=await a.from("stocks").select("id, stock").order("stock",{ascending:!0});if(t)throw t;if(!e)return[];const o=Z.safeParse(e);if(!o.success)throw o.error;return o.data.map(e=>({id:e.id,display_name:e.stock.toString()}))}B(he);const{errorMessage:ge,isLoading:ve,execute:ye}=E(async e=>{const t=R.safeParse({p_palox_type_id:e.paloxTypeId,p_palox_number:e.paloxNumber,p_stock_column_slot_id:e.stockColumnSlotId,p_product_id:e.productId,p_supplier_id:e.supplierId,p_customer_id:e.customerId});if(!t.success)throw t.error;const{data:o,error:n}=await a.rpc("assign_palox_to_next_free_level_in_slot_fnc",{...t.data,p_customer_id:t.data.p_customer_id??void 0});if(n)throw n;return o}),ke=e("u",o("paloxIntoStock",{state:()=>({currentStep:1,selectedPaloxType:null,selectedPaloxNumber:null,selectedSupplier:null,selectedCustomer:null,selectedProduct:null,selectedStock:null,selectedStockColumnSlot:null}),getters:{isActionLoading:()=>ve.value,actionErrorMessage:()=>ge.value,canProceed(e){switch(e.currentStep){case 1:return Boolean(e.selectedPaloxType&&e.selectedPaloxNumber&&e.selectedSupplier&&e.selectedProduct&&e.selectedStock);case 2:return Boolean(e.selectedStockColumnSlot);default:return!1}}},actions:{async submitStepTwo(){return await ye({paloxTypeId:this.selectedPaloxType.id,paloxNumber:this.selectedPaloxNumber,stockColumnSlotId:this.selectedStockColumnSlot.slot_id,productId:this.selectedProduct.id,supplierId:this.selectedSupplier.id,customerId:this.selectedCustomer?.id})},async nextStep(){if(!this.canProceed)return{success:!1,showSuccessToast:!1,closeModal:!1};if(this.currentStep>=2){const e=await this.submitStepTwo();return{success:e,showSuccessToast:e,closeModal:!0}}return this.currentStep++,{success:!0,showSuccessToast:!1,closeModal:!1}},prevStep(){this.currentStep>1&&this.currentStep--}}})),we=D({id:$(),display_name:L().nullable()}),be=o("stockStore",{state:()=>({_currentStockItem:null}),getters:{getCurrentStockItem:e=>e._currentStockItem},actions:{setCurrentStockItem(e){if(!e)return void(this._currentStockItem=null);const t=we.safeParse(e);if(!t.success)throw t.error;this._currentStockItem=t.data}},persist:!0}),xe={class:"toolbar-content"},Se=["onClick","aria-label"],Me={class:"popover-buttons"},Ce=K(n({__name:"PaloxTabs",emits:["refetch-parent-data"],setup(e,{emit:a}){const o=z({loader:()=>T(()=>t.import("./DropdownSearchModal-legacy-DVoNYGt-.js"),void 0),loadingComponent:V,delay:200}),n=z({loader:()=>T(()=>t.import("./PaloxIntoStockStepperModal-legacy-Bj6KgULf.js"),void 0),loadingComponent:V,delay:200}),D=ke(),$=be(),B=s(!1),H=s(null),N=l(()=>$.getCurrentStockItem?.display_name||"-"),A=a;function L(){B.value=!1}function E(e){e.preventDefault(),H.value=e,B.value=!0}function O(){$.$reset(),L(),j("Standardlager erfolgreich zur√ºckgesetzt.","success",3e3)}async function F(){const e=await I.create({component:o,componentProps:{title:"Standardlager",fetchMethod:fe,isSearchable:!1,searchType:"numeric"}});await e.present();const{data:t}=await e.onDidDismiss();if(t)try{$.setCurrentStockItem(t)}catch(a){j(q(a),"danger",1e4)}}const G=[{label:"Einlagern",icon:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='icon%20icon-tabler%20icons-tabler-outline%20icon-tabler-box'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%203l8%204.5l0%209l-8%204.5l-8%20-4.5l0%20-9l8%20-4.5'%20/%3e%3cpath%20d='M12%2012l8%20-4.5'%20/%3e%3cpath%20d='M12%2012l0%209'%20/%3e%3cpath%20d='M12%2012l-8%20-4.5'%20/%3e%3c/svg%3e",handler:async function(){D.$reset();const e=await I.create({component:n});await e.present();const{data:t}=await e.onDidDismiss();t&&A("refetch-parent-data")}},{label:"Sortieren",icon:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='icon%20icon-tabler%20icons-tabler-outline%20icon-tabler-sort-ascending-2'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M14%209l3%20-3l3%203'%20/%3e%3cpath%20d='M5%205m0%20.5a.5%20.5%200%200%201%20.5%20-.5h4a.5%20.5%200%200%201%20.5%20.5v4a.5%20.5%200%200%201%20-.5%20.5h-4a.5%20.5%200%200%201%20-.5%20-.5z'%20/%3e%3cpath%20d='M5%2014m0%20.5a.5%20.5%200%200%201%20.5%20-.5h4a.5%20.5%200%200%201%20.5%20.5v4a.5%20.5%200%200%201%20-.5%20.5h-4a.5%20.5%200%200%201%20-.5%20-.5z'%20/%3e%3cpath%20d='M17%206v12'%20/%3e%3c/svg%3e",handler:function(){}},{label:"Verschieben",icon:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='icon%20icon-tabler%20icons-tabler-outline%20icon-tabler-reorder'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M3%2015m0%201a1%201%200%200%201%201%20-1h2a1%201%200%200%201%201%201v2a1%201%200%200%201%20-1%201h-2a1%201%200%200%201%20-1%20-1z'%20/%3e%3cpath%20d='M10%2015m0%201a1%201%200%200%201%201%20-1h2a1%201%200%200%201%201%201v2a1%201%200%200%201%20-1%201h-2a1%201%200%200%201%20-1%20-1z'%20/%3e%3cpath%20d='M17%2015m0%201a1%201%200%200%201%201%20-1h2a1%201%200%200%201%201%201v2a1%201%200%200%201%20-1%201h-2a1%201%200%200%201%20-1%20-1z'%20/%3e%3cpath%20d='M5%2011v-3a3%203%200%200%201%203%20-3h8a3%203%200%200%201%203%203v3'%20/%3e%3cpath%20d='M16.5%208.5l2.5%202.5l2.5%20-2.5'%20/%3e%3c/svg%3e",handler:function(){}},{label:"Tauschen",icon:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='icon%20icon-tabler%20icons-tabler-outline%20icon-tabler-replace'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M3%203m0%201a1%201%200%200%201%201%20-1h4a1%201%200%200%201%201%201v4a1%201%200%200%201%20-1%201h-4a1%201%200%200%201%20-1%20-1z'%20/%3e%3cpath%20d='M15%2015m0%201a1%201%200%200%201%201%20-1h4a1%201%200%200%201%201%201v4a1%201%200%200%201%20-1%201h-4a1%201%200%200%201%20-1%20-1z'%20/%3e%3cpath%20d='M21%2011v-3a2%202%200%200%200%20-2%20-2h-6l3%203m0%20-6l-3%203'%20/%3e%3cpath%20d='M3%2013v3a2%202%200%200%200%202%202h6l-3%20-3m0%206l3%20-3'%20/%3e%3c/svg%3e",handler:function(){}},{label:"Auslagern",icon:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='icon%20icon-tabler%20icons-tabler-outline%20icon-tabler-box-off'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M17.765%2017.757l-5.765%203.243l-8%20-4.5v-9l2.236%20-1.258m2.57%20-1.445l3.194%20-1.797l8%204.5v8.5'%20/%3e%3cpath%20d='M14.561%2010.559l5.439%20-3.059'%20/%3e%3cpath%20d='M12%2012v9'%20/%3e%3cpath%20d='M12%2012l-8%20-4.5'%20/%3e%3cpath%20d='M3%203l18%2018'%20/%3e%3c/svg%3e",handler:function(){}}];return(e,t)=>(i(),r(w,null,[c(p(S),null,{default:d(()=>[c(p(u),null,{default:d(()=>[m("div",xe,[c(p(_),{onClick:F,onContextmenu:h(E,["prevent"]),onPointerdown:t[0]||(t[0]=h(()=>{},["stop"])),onMousedown:t[1]||(t[1]=h(()=>{},["stop"])),onTouchstart:t[2]||(t[2]=h(()=>{},["stop"]))},{default:d(()=>[c(p(f),{icon:p(g)},null,8,["icon"]),c(p(v),null,{default:d(()=>[y(k(N.value),1)]),_:1})]),_:1}),(i(),r(w,null,b(G,e=>m("div",{key:e.label,class:"ion-activatable ripple-parent",onClick:e.handler,"aria-label":e.label},[c(p(f),{src:e.icon,size:"large"},null,8,["src"]),c(p(x))],8,Se)),64))])]),_:1})]),_:1}),c(p(P),{"is-open":B.value,event:H.value,onDidDismiss:L,"keep-contents-mounted":!0},{default:d(()=>[c(p(M),{class:"ion-padding"},{default:d(()=>[t[5]||(t[5]=m("p",null,"Standardlager zur√ºcksetzen?",-1)),m("div",Me,[c(p(C),{color:"medium",fill:"outline",expand:"block",onClick:L},{default:d(()=>[...t[3]||(t[3]=[y(" Nein ",-1)])]),_:1}),c(p(C),{color:"primary",expand:"block",onClick:O},{default:d(()=>[...t[4]||(t[4]=[y(" Ja ",-1)])]),_:1})])]),_:1})]),_:1},8,["is-open","event"])],64))}}),[["__scopeId","data-v-972fe490"]]),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"}));e("P",Pe)}}});
