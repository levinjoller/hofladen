import{t as w,d as I,v as L,x as b,a as k,w as r,e,o as x,b as a,I as D,f as N,p as j,q as B,g as C,h as T,i as v,m as S,y as V}from"./index-B4NoDcFB.js";import{o as f,a as A,u as M,A as F,t as G}from"./use-db-action-CqLjSPSZ.js";import{P as $,a as q}from"./product-types-BIT3DkQM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z=f({...$.omit({fk_product_type:!0}).shape,type:f({...q.pick({display_name:!0,emoji:!0}).shape})}),E=A(z);async function H(){const{data:n,error:u}=await w.from("products").select("\n      id, \n      display_name,\n      created_at,\n      type:fk_product_type (\n        display_name,  \n        emoji\n      )\n      ").order("display_name",{ascending:!0});if(u)throw u;if(!n)return[];const o=E.safeParse(n);if(!o.success)throw o.error;return o.data}const O=I({__name:"ProductListPage",setup(n){const o=[{headerName:"Bezeichnung",field:"display_name"},{headerName:"Kategorie",valueGetter:t=>{var d,c,i,l,p,m;const s=(i=(c=(d=t.data)==null?void 0:d.type)==null?void 0:c.emoji)!=null?i:"",g=(m=(p=(l=t.data)==null?void 0:l.type)==null?void 0:p.display_name)!=null?m:"";return"".concat(s," ").concat(g)}},{headerName:"Erstellt am",field:"created_at",valueFormatter:G}],{data:_,isLoading:y,errorMessage:h,execute:P}=M(H);return L(async()=>{await P()}),b(h,t=>{t&&V(t,"danger",1e4)}),(t,s)=>(x(),k(e(S),null,{default:r(()=>[a(e(D),{translucent:!0},{default:r(()=>[a(e(N),null,{default:r(()=>[a(e(j),{slot:"start"},{default:r(()=>[a(e(B))]),_:1}),a(e(C),null,{default:r(()=>[...s[0]||(s[0]=[T("Produkte Ãœbersicht",-1)])]),_:1})]),_:1})]),_:1}),a(e(v),{fullscreen:!0},{default:r(()=>[a(F,{rowData:e(_),columnDefs:o,isParentLoading:e(y)},null,8,["rowData","isParentLoading"])]),_:1})]),_:1}))}});export{O as default};
