import{d as N,r as k,v as C,x as _,a as d,o as l,w as a,b as n,e,I as F,f as M,p as D,l as K,F as L,aD as V,g as E,h as b,aw as p,i as $,aE as T,A as y,aF as H,aG as O,B as R,s as j,aH as A,ax as G,ay as P,j as Z,av as q,m as z,aB as w,aI as J}from"./index-B4NoDcFB.js";import{u as Q}from"./use-db-action-CqLjSPSZ.js";import{i as U}from"./is-numeric-key-DsADXjeW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={key:1,class:"ion-text-center loading-spinner-container"},X={key:2},Y={class:"ion-text-center"},se=N({__name:"DropdownSearchModal",props:{title:{},fetchMethod:{type:Function},isSearchable:{type:Boolean},searchType:{}},setup(t){const u=t,{data:s,isLoading:I,execute:h}=Q(u.fetchMethod),m=k(null),f=k("");C(async()=>{u.isSearchable||await h()}),_(()=>u.isSearchable,async c=>{c&&await J(()=>{setTimeout(()=>{m.value&&m.value.$el.setFocus()},100)})},{immediate:!0});const x=async c=>{const i=c.target.value;f.value=i;const o=u.searchType==="numeric",r=o?i.replace(/\D/g,""):i;if(o){const g=parseInt(r);if(!r||isNaN(g))return s.value=[];await h(g)}else r.length>=3?await h(r):s.value=[]},B=()=>{s.value.length>0&&v(s.value[0])},v=c=>{w.dismiss(c)};function S(){w.dismiss()}return(c,i)=>(l(),d(e(z),null,{default:a(()=>[n(e(F),null,{default:a(()=>[n(e(M),null,{default:a(()=>[n(e(D),{slot:"start"},{default:a(()=>[n(e(K),{onClick:S},{default:a(()=>[n(e(L),{icon:e(V)},null,8,["icon"])]),_:1})]),_:1}),n(e(E),null,{default:a(()=>[b("Suchen nach "+p(t.title),1)]),_:1})]),_:1})]),_:1}),n(e($),{class:"ion-padding"},{default:a(()=>[t.isSearchable?(l(),d(e(H),{key:0,ref_key:"searchbarRef",ref:m,placeholder:t.searchType==="numeric"?"Nummer eintippen...":"Min. 3 Zeichen eintippen...",inputmode:t.searchType==="numeric"?"numeric":"text",debounce:300,onIonInput:x,onKeydown:[O(B,["enter"]),i[0]||(i[0]=o=>t.searchType==="numeric"?e(U):void 0)]},null,8,["placeholder","inputmode"])):T("",!0),e(I)?(l(),y("div",W,[n(e(R),{name:"crescent"})])):!e(I)&&e(s).length===0&&(t.searchType==="numeric"?f.value.length>0:f.value.length>=3)?(l(),y("div",X,[j("p",Y,"Kein/e "+p(t.title)+" gefunden.",1)])):e(s).length>0?(l(),d(e(A),{key:3},{default:a(()=>[(l(!0),y(G,null,P(e(s),o=>(l(),d(e(Z),{key:o.id,button:"",onClick:r=>v(o)},{default:a(()=>[n(e(q),null,{default:a(()=>[b(p(o.display_name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):T("",!0)]),_:1})]),_:1}))}});export{se as default};
