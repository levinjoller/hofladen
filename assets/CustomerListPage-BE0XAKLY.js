import{t as c,d as m,v as f,x as p,a as _,w as t,e,o as h,b as a,I as g,f as w,p as y,q as C,g as I,h as x,i as L,m as P,y as b}from"./index-B4NoDcFB.js";import{u as D,A as N,t as B}from"./use-db-action-CqLjSPSZ.js";import{C as T}from"./customer-list-schema-CSgvwQ6m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./persons-Cmw6zaTL.js";async function k(){const{data:o,error:r}=await c.from("customers").select("\n      id,\n      created_at,\n      person:fk_person (\n        display_name\n      )\n    ");if(r)throw r;if(!o)return[];const s=T.safeParse(o);if(!s.success)throw s.error;return s.data.sort((n,l)=>n.person.display_name.localeCompare(l.person.display_name))}const W=m({__name:"CustomerListPage",setup(o){const r=[{headerName:"Name",field:"person.display_name"},{headerName:"Erstellt am",field:"created_at",valueFormatter:B}],{data:s,isLoading:n,errorMessage:l,execute:d}=D(k);return f(async()=>{await d()}),p(l,u=>{u&&b(u,"danger",1e4)}),(u,i)=>(h(),_(e(P),null,{default:t(()=>[a(e(g),{translucent:!0},{default:t(()=>[a(e(w),null,{default:t(()=>[a(e(y),{slot:"start"},{default:t(()=>[a(e(C))]),_:1}),a(e(I),null,{default:t(()=>[...i[0]||(i[0]=[x("Kunden Ãœbersicht",-1)])]),_:1})]),_:1})]),_:1}),a(e(L),{fullscreen:!0},{default:t(()=>[a(N,{rowData:e(s),columnDefs:r,isParentLoading:e(n)},null,8,["rowData","isParentLoading"])]),_:1})]),_:1}))}});export{W as default};
